<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>举个例子分析执行上下文</title>

    <script type="text/javascript">


        /**
         * 
         *  在讨论闭包之前，让我们看下下方的代码(建议先只看代码自己头脑风暴再看笔记中的描述),也算是对上面知识点的梳理回顾：
         * 
        */


        /**
         * 
         *  为了理解 JavaScript 引擎是如何工作的，让我们详细分析一下：
         *  1. 在第 1 行，我们在全局执行上下文中声明了一个新变量 a，并将赋值为 3。
         *  2. 接下来就变得棘手了，第 2 行到第 5 行实际上是在一起的。这里发生了什么?
         *      - 我们在全局执行上下文中声明了一个名为addTwo的新变量,我们给它分配了什么? -- >一个函数定义。
         *      - 两个括号{}之间的任何内容都被分配给addTwo，函数内部的代码没有被求值，没有被执行，只是存储在一个变量中以备将来使用。
         * 
         *  3. 现在我们在第 6 行。
         *      - 它看起来很简单，但是这里有很多东西需要拆开分析。
         *        首先，我们在全局执行上下文中声明一个新变量，并将其标记为[b]，变量一经声明，其值即为 undefined
         *      - 接下来，仍然在第 6 行，我们看到一个赋值操作符。
         *        我们准备给变量b赋一个新值，接下来我们看到一个函数被调用。
         *        当您看到一个变量后面跟着一个圆括号(…)时，这就是调用函数的信号，
         *        接着，每个函数都返回一些东西(值、对象或 undefined)，无论从函数返回什么，都将赋值给变量b。
         * 
         *  4. 但是首先我们需要调用标记为addTwo的函数。JavaScript 将在其全局执行上下文内存中查找名为addTwo的变量。
         *     噢，它找到了一个，它是在[步骤 2(或第 2 - 5 行)中定义]的。变量[addTwo]包含一个函数定义。
         *      - 注意:变量[a]作为参数传递给函数
         *      - JavaScript 在全局执行上下文内存中搜索变量a，找到它，发现它的值是 3，并将数字 3 作为参数传递给函数，准备好执行函数。
         *  
         *  5. 现在执行上下文将切换,创建了一个新的本地执行上下文，
         *     我们将其命名为[“addTwo 执行上下文”，执行上下文被推送到调用堆栈上。
         *     在 addTwo 执行上下文中，我们要做的第一件事是什么?
         *      - 你可能会说，“在 addTwo 执行上下文中声明了一个新的变量 ret”，这是不对的。
         *      - 正确的答案是:我们需要先看函数的参数。在 addTwo 执行上下文中声明一个新的变量[x]，因为值 3 是作为参数传递的，所以变量 x 被赋值为 3。
         *      - 下一步才是在 addTwo 执行上下文中声明一个新的变量ret。它的值被设置为 undefined(第三行)。
         *  
         * 
         *  6. 仍然是第 3 行，需要执行一个相加操作。
         *      - 首先我们需要x的值，JavaScript 会寻找一个变量x，
         *        它会首先在addTwo执行上下文中寻找，找到了一个值为 3。
         *        第二个操作数是数字 2。两个相加结果为 5 就被分配给变量ret。
         * 
         *  7. 第 4 行，我们返回变量ret的内容，在 addTwo 执行上下文中查找，找到值为 5，返回，函数结束。
         *  8. 第 4 - 5 行，函数结束。
         *      - addTwo 执行上下文被销毁，变量x和ret被消去了，它们已经不存在了。
         *        addTwo 执行上下文从调用堆栈中弹出，返回值返回给调用上下文，在这种情况下，调用上下文是全局执行上下文，
         *        因为函数addTwo 是从全局执行上下文调用的。
         * 
         *  9. 现在我们继续第 4 步的内容，返回值 5 被分配给变量b，此时实际上程序仍然在第 6 行
         *  10. 在第 7 行，b的值 5 被打印到控制台了。
         * 
         *  
        */

        


        // 1: let a = 3;
        // 2: function addTwo(x) {
        // 3:      let ret = x + 2;
        // 4:    return ret;
        // 5: }
        // 6: let b = addTwo(a);
        // 7: console.log(b);  // 5


    </script>
</head>

<body>




</body>

</html>